library(data.table)
library(randomForest)
library(tidyverse)
library(caret)

train1= fread("C:/Users/abrow/OneDrive/Assignments/R/train.csv", nrows=1000000,header=F, skip=1)
train2= fread("C:/Users/abrow/OneDrive/Assignments/R/train.csv", nrows=1000000,header=F, skip=1000001)
train3= fread("C:/Users/abrow/OneDrive/Assignments/R/train.csv", nrows=1000000,header=F, skip=2000001)
train4= fread("C:/Users/abrow/OneDrive/Assignments/R/train.csv", nrows=1000000,header=F, skip=3000001)
train5= fread("C:/Users/abrow/OneDrive/Assignments/R/train.csv", nrows=1000000,header=F, skip=4000001)
train6= fread("C:/Users/abrow/OneDrive/Assignments/R/train.csv", nrows=1000000,header=F, skip=5000001)
train7= fread("C:/Users/abrow/OneDrive/Assignments/R/train.csv", nrows=1000000,header=F, skip=6000001)
train8= fread("C:/Users/abrow/OneDrive/Assignments/R/train.csv", nrows=2000000,header=F, skip=7000001)

numCols1 = sapply(train1, is.numeric)
numCols2 = sapply(train2, is.numeric)
numCols3 = sapply(train3, is.numeric)
numCols4 = sapply(train4, is.numeric)
numCols5 = sapply(train5, is.numeric)
numCols6 = sapply(train6, is.numeric)
numCols7 = sapply(train7, is.numeric)
numCols8 = sapply(train8, is.numeric)

train1[is.na(train1)] = 0
train2[is.na(train2)] = 0
train3[is.na(train3)] = 0
train4[is.na(train4)] = 0
train5[is.na(train5)] = 0
train6[is.na(train6)] = 0
train7[is.na(train7)] = 0
train8[is.na(train8)] = 0

train1 = as.data.frame(train1)
train2 = as.data.frame(train2)
train3 = as.data.frame(train3)
train4 = as.data.frame(train4)
train5 = as.data.frame(train5)
train6 = as.data.frame(train6)
train7 = as.data.frame(train7)
train8 = as.data.frame(train8)

train1$V83 = as.factor(as.character(train1$V83))
train2$V83 = as.factor(as.character(train2$V83))
train3$V83 = as.factor(as.character(train3$V83))
train4$V83 = as.factor(as.character(train4$V83))
train5$V83 = as.factor(as.character(train5$V83))
train6$V83 = as.factor(as.character(train6$V83))
train7$V83 = as.factor(as.character(train7$V83))
train8$V83 = as.factor(as.character(train8$V83))

set.seed(11)
f1=randomForest(V83~., data=train1[,numCols1], ntree=10, do.trace=T, importance=T)
set.seed(22)
f2=randomForest(V83~., data=train2[,numCols2], ntree=10, do.trace=T, importance=T)
set.seed(33)
f3=randomForest(V83~., data=train3[,numCols3], ntree=10, do.trace=T, importance=T)
set.seed(44)
f4=randomForest(V83~., data=train4[,numCols4], ntree=10, do.trace=T, importance=T)
set.seed(55)
f5=randomForest(V83~., data=train5[,numCols5], ntree=10, do.trace=T, importance=T)
set.seed(66)
f6=randomForest(V83~., data=train6[,numCols6], ntree=10, do.trace=T, importance=T)
set.seed(77)
f7=randomForest(V83~., data=train7[,numCols7], ntree=10, do.trace=T, importance=T)
set.seed(88)
f8=randomForest(V83~., data=train8[,numCols8], ntree=10, do.trace=T, importance=T)

test1= fread("C:/Users/abrow/OneDrive/Assignments/R/test.csv", nrows=1000000,header=F, skip=1)
test2= fread("C:/Users/abrow/OneDrive/Assignments/R/test.csv", nrows=1000000,header=F, skip=1000001)
test3= fread("C:/Users/abrow/OneDrive/Assignments/R/test.csv", nrows=1000000,header=F, skip=2000001)
test4= fread("C:/Users/abrow/OneDrive/Assignments/R/test.csv", nrows=1000000,header=F, skip=3000001)
test5= fread("C:/Users/abrow/OneDrive/Assignments/R/test.csv", nrows=1000000,header=F, skip=4000001)
test6= fread("C:/Users/abrow/OneDrive/Assignments/R/test.csv", nrows=1000000,header=F, skip=5000001)
test7= fread("C:/Users/abrow/OneDrive/Assignments/R/test.csv", nrows=1000000,header=F, skip=6000001)
test8= fread("C:/Users/abrow/OneDrive/Assignments/R/test.csv", nrows=1000000,header=F, skip=7000001)

test1[is.na(test1)] = 0
test2[is.na(test2)] = 0
test3[is.na(test3)] = 0
test4[is.na(test4)] = 0
test5[is.na(test5)] = 0
test6[is.na(test6)] = 0
test7[is.na(test7)] = 0
test8[is.na(test8)] = 0

test1 = as.data.frame(test1)
test2 = as.data.frame(test2)
test3 = as.data.frame(test3)
test4 = as.data.frame(test4)
test5 = as.data.frame(test5)
test6 = as.data.frame(test6)
test7 = as.data.frame(test7)
test8 = as.data.frame(test8)

pred1 <- predict(f1, newdata = test1, type="prob")
pred2 <- predict(f2, newdata = test2, type="prob")
pred3 <- predict(f3, newdata = test3, type="prob")
pred4 <- predict(f4, newdata = test4, type="prob")
pred5 <- predict(f5, newdata = test5, type="prob")
pred6 <- predict(f6, newdata = test6, type="prob")
pred7 <- predict(f7, newdata = test7, type="prob")
pred8 <- predict(f8, newdata = test8, type="prob")

subm <- fread("C:/Users/abrow/OneDrive/Assignments/R/sample_submission.csv")
subm[1:1000000,2] <- pred1[,2]
subm[1000001:2000000,2] <- pred2[,2]
subm[2000001:3000000,2] <- pred3[,2]
subm[3000001:4000000,2] <- pred4[,2]
subm[4000001:5000000,2] <- pred5[,2]
subm[5000001:6000000,2] <- pred6[,2]
subm[6000001:7000000,2] <- pred7[,2]
subm[7000001:7853253,2] <- pred8[,2]
write.csv(subm, file='Contest1Attempt1.csv', row.names=FALSE)